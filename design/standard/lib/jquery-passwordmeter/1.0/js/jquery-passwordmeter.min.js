(function(a){a.fn.passwordmeter=function(b){var c={callback:function(){return true},length:[{size:6,points:6},{size:0,points:3},{size:8,points:6},{size:16,points:6}],event:"keyup",levels:[{level:"veryweak",score:[0,16],label:"Very weak"},{level:"weak",score:[16,25],label:"Weak"},{level:"mediocre",score:[25,35],label:"Mediocre"},{level:"strong",score:[35,45],label:"Strong"},{level:"verystrong",score:[45,60],label:"Very strong"}],submit:{level:"strong",exclude:["DiscardButton"]},rules:[{regex:"[a-z]",points:1},{regex:"[A-Z]",points:5},{regex:"\d+",points:5},{regex:"(.*[0-9].*[0-9].*[0-9])",points:5},{regex:".[!,@,#,$,%,^,&,*,?,_,~]",points:5},{regex:"(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])",points:5},{regex:"([a-z].*[A-Z])|([A-Z].*[a-z])",points:2},{regex:"([a-zA-Z]).*([0-9])|([0-9]).*([a-zA-Z])",points:2},{regex:"([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])",points:2}]};var b=a.extend(c,b);return this.each(function(){var h=a(this);var g=function(k){var j=a.fn.meter(h.val(),b);if(h.parent().find(".passwordmeter").length<1){a('<div class="passwordmeter"></div>').insertAfter(h)}var l=h.parent().find(".passwordmeter");l.removeClass().addClass("passwordmeter "+j.level);l.html('<div class="label">'+j.label+"</div>")};h.bind(b.event,g);var f=h.closest("form");var e=undefined;f.find(":submit").bind("click keyup",function(){e=a(this)});var i={};for(var d in b.levels){if(b.submit.level==b.levels[d].level){i=b.levels[d];break}}f.submit(function(){if(a.inArray(e.attr("name"),b.submit.exclude)<=-1){var j=a.fn.meter(h.val(),b);if(j.score[0]<i.score[0]){alert("Please write a strong password");return false}}})})};a.fn.meter=function(b,d){var g=0;var f={};for(var e in d.length){if(b.length>=d.length[e].size){g=(g+d.length[e].points)}}for(var e in d.rules){if(b.match(d.rules[e].regex)){g=(g+d.rules[e].points)}}for(var c in d.levels){if(g>=d.levels[c].score[0]&&g<d.levels[c].score[1]){f=d.levels[c];break}}return f}})(jQuery);